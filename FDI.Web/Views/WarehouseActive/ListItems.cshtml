@using FDI.CORE
@model FDI.Simple.ModelDNRequestWareHouseItem
@{
    Layout = "~/Views/Shared/_Ajax.cshtml";
    var stt = 1;
}
<div id="mygird">
    <div class="box-control">
        <div class="scrollable box-control-content">
            <table class="gridView table table-striped table-bordered table-hover table-orimid" role="grid">
                <thead>
                    <tr>
                        <th class="text-center"><a href="#Field=ID">STT</a></th>
                        <th class="text-center">Tên sản phẩm</th>
                        <th class="text-center">Số lượng</th>
                        <th class="text-center w250">Thực duyệt</th>
                        <th class="text-center">Thao tác</th>
                       
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.ListItems)
                    {
                        var rowspan = item.Details.Count() + 1;
                        <tr data-id="@item.ID" title="@item.Code" class="product" rowspan="2">
                            <td rowspan="@rowspan" class="text-center">@stt</td>
                            <td rowspan="@rowspan" class="text-center">@item.ProductName</td>
                            <td rowspan="@rowspan" class="text-center">@item.Quantity.Quantity()</td>
                            <td rowspan="@rowspan" class="text-center">
                                <input type="number" class="Update_Q-@(item.GID)" step="0.5" min="0.5" style="width: 50px" value="@item.QuantityActive.Quantity()" />
                            </td>
                            <td rowspan="@rowspan" class="text-center">
                                <a class="btn btn-sm btn-default Update_Quantity" data-guid="@item.GID"><i class="fa fa-save" style="color: #04A827;"></i></a>
                                @*<a class="btn btn-sm btn-default seedetail" data-guid="@item.GID"><i class="fa fa-eye" style="color: #04A827;"></i></a>*@
                            </td>
                      

                        </tr>
                        foreach (var detail in item.Details)
                        {
                            <tr title="@item.Code" class="productdetail product_@item.GID">

                                <td>@detail.ProductName</td>
                                <td class="text-center">@detail.Weight</td>
                            </tr>
                        }
                        stt++;
                    }
                </tbody>
            </table>
        </div>
    </div>
    <div class="footer-control">
        @if (Model.PageHtml != null)
        {
            @Html.Raw(Model.PageHtml)
        }
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        registerGridView('#mygird');
      
        $(".btn_Inport").click(function () {
            var id = $(this).attr("data-id");
            var action = $(this).attr("data-action");
            FdiOpenDialog("#dialog-form-4", urlForm + "?ItemId=" + id + "&do=" + action, "Chỉnh sửa phiếu yêu cầu nhập kho");
        });
        $(".Update_Quantity").click(function () {
            var gId = $(this).data("guid");
            var quantity = $(".Update_Q-" + gId).val();
            var url = '@Url.Action("UpdateQuantity")';
            $.post(url, { gid: gId, quantity: quantity }, function (data) {
                if (data.Erros) {
                    createMessage("Báo lỗi", data.Message);
                } else {
                    createCloseMessage("Thành công", data.Message);
                }
            });
        });
        $(".btnAddSupplier").click(function () {
            var id = $(this).attr("data-id");
            var action = $(this).attr("data-action");
            FdiOpenDialog("#dialog-form-4", '@Url.Action("AddSupplierView")' +'?RequestWareId=' + id, "Chọn nhà cung cấp");
        });
        $(".btnDeleteSupplier").click(function() {
            var id = $(this).attr("data-id");
            $.post('@Url.Action("DeleteSupplier")' + '?id=' + id,
                {},
                function(data) {
                    if (data.Erros==false) {
                        window.location.reload();
                    }
                });
        });
    });
</script>
<script src="~/Content/Admin/js/jQuery.print.js"></script>
<script src="~/Content/Admin/js/numeral.min.js"></script>