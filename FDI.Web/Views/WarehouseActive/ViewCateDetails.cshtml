@using FDI.CORE
@using FDI.CORE
@model List<FDI.Base.Product_Value>
@{

    Layout = "~/Views/Shared/_Ajax.cshtml";
    var stt = 1;
    decimal total = 0;
}

<div class="modal-body">
    <div id="PrintContent" class="portlet box green">
        <div class="portlet-title">
            <div class="caption">
                <i class="fa fa-external-link-square"></i>Danh sách sản phẩm đã nhập
            </div>
        </div>
        <div class="portlet-body form">
            <div class="form-body">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Mã SP</th>
                            <th>Tên SP</th>
                            <th>Số lượng</th>
                            <th>Kg</th>
                            <th>NSX</th>
                            <th>HSD</th>
                            <th>Barcode</th>
                            <th>Giá nhập</th>
                            <th>Thành tiền</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>@(stt++)</td>
                                <td>@item.Shop_Product_Detail.Code</td>
                                <td>
                                    @if (item.IsDelete == true)
                                    {
                                        <strike>@item.Shop_Product_Detail.Name</strike>
                                    }
                                    else
                                    {
                                        <span>@item.Shop_Product_Detail.Name</span>
                                    }
                                </td>
                                <td>@item.Quantity</td>
                                <td>@item.Value.Quantity()</td>
                                <td>@item.DateImport.DecimalToString("dd/MM/yyyy")</td>
                                <td>@item.DateImport.DecimalToDate().AddMonths(item.Shop_Product_Detail.QuantityDay ?? 0).ToString("dd/MM/yyyy")</td>
                                <td>@item.Barcode</td>
                                <td>@item.PriceNew.Money()</td>
                                <td>@item.PriceNew.Money()</td>
                                <td>
                                    <a class="btn btn-default Viewdetail" data-id="@item.ID"><i class="fa fa-eye"></i></a>
                                </td>
                            </tr>
                            total += item.PriceNew ?? 0;
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="10">Tổng tiền: @total.Money()</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button type="button" onclick="printDiv('PrintContent')" class="btn btn-primary btn-sm">In phiếu</button>
    <button type="button" data-dismiss="modal" class="btn btn-primary btn-sm">Đóng</button>
</div>
@* In phiếu *@
<script src="~/Content/Admin/js/jQuery.print.js"></script>
<script src="~/Content/Admin/js/numeral.min.js"></script>
<script>
    $(function() {
        $(".Viewdetail").click(function () {
            var id = $(this).data("id");
            var urlform = '@Url.Action("Viewdetai","StorageWarehouse")';
            $.post(urlform, { id: id }, function (data) {
                $("#dialog-form-2 .modal-title").html("Chi tiết sản phẩm");
                $("#dialog-form-2 #dialog-form-ajax").html(data);
                $('#dialog-form-2').modal('show');
            });
            return false;
        });
    })
</script>