@using FDI.CORE
@using FDI.CORE
@model FDI.Simple.StorageWarehousingItem
@{

    Layout = "~/Views/Shared/_Ajax.cshtml";
    var stt = 1;
}

<div class="modal-body">
    <div id="PrintContent" class="portlet box green">
        <div class="portlet-title">
            <div class="caption">
                <i class="fa fa-newspaper-o"></i>Thông tin về phiếu nhập
            </div>
        </div>
        <div class="portlet-body form">
            <div class="form-body">
                <table class="table table-bordered">
                    <tr>
                        <td style="width: 15%">
                            <label>Mã phiếu</label>
                        </td>
                        <td>
                            @Model.Code
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Người nhập</label>
                        </td>
                        <td>
                            @Model.UsernameCreate
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Ngày tạo</label>
                        </td>
                        <td>
                            @Model.DateCreated.DecimalToString("dd/MM/yyyy")
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Ngày nhập</label>
                        </td>
                        <td>
                            @Model.DateImport.DecimalToString("dd/MM/yyyy")
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Tổng tiền</label>
                        </td>
                        <td>
                            @string.Format("{0:0,0}", Model.TotalPrice)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Ghi chú</label>
                        </td>
                        <td>
                            @Model.Note
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>In danh sách</label>
                        </td>
                        <td>
                            <button class="print default" id="btn_Print"><i class="fa fa-print"></i>In</button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="portlet-title">
            <div class="caption">
                <i class="fa fa-external-link-square"></i>Danh sách sản phẩm yêu cầu
            </div>
        </div>
        <div class="portlet-body form">
            <div class="form-body">
                <table class="table table-bordered">
                    <tr>
                        <th>STT</th>
                        <th>Mã SP</th>
                        <th>Tên SP</th>
                        <th>Số lượng</th>
                        <th>Số lượng</th>
                        <th>Giá nhập</th>
                        <th>Thành tiền</th>
                        <th>Trạng thái</th>
                    </tr>
                    @foreach (var item in Model.LstImport)
                    {
                        <tr>
                            <td>@(stt++)</td>
                            <td>@item.Code</td>
                            <td>
                                @if (item.IsDelete == true)
                                {
                                    <strike>@item.ProductName</strike>
                                }
                                else
                                {
                                    <span>@item.ProductName</span>
                                }
                            </td>
                            <td>@item.Quantity</td>    
                            <td>@item.QuantityActive</td>
                            <td>@item.Price.Money()</td>
                            <td>@((item.Price * (item.Quantity ?? 0)).Money())</td>
                            <td>
                                @if (item.IsDelete == true)
                                {
                                    <label class="label label-danger">Đã xóa</label>
                                }
                                else
                                {
                                    <label class="label label-success">Hoàn thành</label>
                                }
                            </td>
                        </tr>
                    }

                </table>
            </div>
        </div>
        <div class="portlet-title">
            <div class="caption">
                <i class="fa fa-external-link-square"></i>Danh sách sản phẩm đã nhập
            </div>
        </div>
        <div class="portlet-body form">
            <div class="form-body">
                <table class="table table-bordered">
                    <tr>
                        <th>STT</th>
                        <th>Mã SP</th>
                        <th>Tên SP</th>
                        <th>Số lượng</th>
                        <th>Barcode</th>
                        <th>Giá nhập</th>
                        <th>Thành tiền</th>
                        <th>Trạng thái</th>
                        <th>Chi tiết</th>
                    </tr>
                    @foreach (var item in Model.LstImportActive)
                    {
                        <tr>
                            <td>@(stt++)</td>
                            <td>@item.Code</td>
                            <td>
                                @if (item.IsDelete == true)
                                {
                                    <strike>@item.ProductName</strike>
                                }
                                else
                                {
                                    <span>@item.ProductName</span>
                                }
                            </td>
                            <td>@item.Quantity</td>
                            <td>@item.BarCode</td>
                            <td>@item.Price.Money()</td>
                            <td>@((item.Price * (item.Quantity ?? 0)).Money())</td>
                            <td>
                                @if (item.IsDelete == true)
                                {
                                    <label class="label label-danger">Đã xóa</label>
                                }
                                else
                                {
                                    <label class="label label-success">Hoàn thành</label>
                                }
                            </td>
                            <td><a href="#" data-id="@item.CateValueID" class="Viewdetail">Xem chi tiết</a></td>
                        </tr>
                    }

                </table>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button type="button" onclick="printDiv('PrintContent')" class="btn btn-primary btn-sm">In phiếu</button>
    <button type="button" data-dismiss="modal" class="btn btn-primary btn-sm">Đóng</button>
</div>
@* In phiếu *@
<script src="~/Content/Admin/js/jQuery.print.js"></script>
<script src="~/Content/Admin/js/numeral.min.js"></script>
<div id="BoxPrint" style="display: none">
    <link href="~/Content/Admin/css/phieuthu.css" rel="stylesheet" />

    <page size="A4">
        <div class="pt-box-wrap">
            <div class="pt-box">
                <div class="pt-head">
                    <div class="left">
                        <ul>

                            <li><strong>Địa chỉ:</strong><span></span></li>
                            <li><strong>Bộ phận:</strong><span></span></li>
                        </ul>
                    </div>
                    <div class="right">
                        <strong>Mẫu số 03 - TT</strong>
                        <span>
                            (Ban hành theo Thông tư số 200/2014/TT-BTC
                            Ngày 22/12/2014 của Bộ Tài chính)
                        </span>
                    </div>
                </div>
                <div class="pt-name">
                   <div class="right">
                        <ul>
                            <li><b>Số:</b><span>@Model.Code</span></li>
                        </ul>
                    </div>
                </div>
                <div class="pt-name">
                    <div class="center">
                        <h3>DANH SÁCH NHẬP HÀNG</h3>
                        <i> Ngày <i>@DateTime.Now.Day</i> Tháng <i>@DateTime.Now.Month</i> Năm <i>@DateTime.Now.Year</i></i>
                    </div>
                </div>
                <div class="pt-detail">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <td>STT</td>
                                <td>Mã</td>
                                <td>Sản phẩm</td>
                                <td>Số lượng</td>
                                <td>Giá bán</td>
                                <td>NSX</td>
                                <td>HSD</td>
                                <td>Barcode</td>
                                <td>Thành tiền</td>
                            </tr>
                            
                            @foreach (var item in Model.LstImportActive)
                            {
                                <tr>
                                    <td class="text-center">@(stt++)</td>
                                    <td>@item.Code</td>
                                    <td>
                                       @item.ProductName
                                    </td>
                                    <td class="text-center">@string.Format("{0:0}", item.Quantity)</td>
                                    <td>@string.Format("{0:0,0}", item.Price)</td>
                                    <td>@item.Date.DecimalToString("dd/MM/yyyy")</td>
                                    <td>@item.DateEnd.DecimalToString("dd/MM/yyyy")</td>
                                    <td>@item.BarCode</td>
                                    <td>@string.Format("{0:0,0}", item.Price * (item.Quantity ?? 0))</td>
                                </tr>
                            }
                        </thead>
                    </table>
                </div>
                <div class="pt-sign item-sign-4">
                    <div class="pt-item-sign">
                        <strong>Thủ kho</strong>
                        <i>(Ký, họ tên, đóng dấu)</i>
                        <div class="pt-wirte-sign"></div>
                    </div>
                    <div class="pt-item-sign">
                        <strong>Kế toán trưởng</strong>
                        <i>(Ký, họ tên)</i>
                        <div class="pt-wirte-sign"></div>
                    </div>
                    <div class="pt-item-sign">
                        <strong>Phụ trách bộ phận</strong>
                        <i>(Ký, họ tên)</i>
                        <div class="pt-wirte-sign">
                            <div class="pt-text-sign"></div>

                        </div>
                    </div>
                    <div class="pt-item-sign">
                        <strong>Người đề nghị</strong>
                        <i>(Ký, họ tên)</i>
                        <div class="pt-wirte-sign"></div>
                        <span></span>
                    </div>
                </div>
            </div>
        </div>
    </page>
</div>
<script>
    $(function () {
        $("#btn_Print").click(function () {
            $('#BoxPrint').show();
            jQuery.print('#BoxPrint');
            $('#BoxPrint').hide();
        });
        $(".Viewdetail").click(function() {
            var id = $(this).data("id");
            var urlform = '@Url.Action("ViewCateDetails","WarehouseActive")';
            $.post(urlform, { id: id }, function (data) {
                $("#dialog-form-3 .modal-title").html("Chi tiết sản phẩm");
                $("#dialog-form-3 #dialog-form-ajax").html(data);
                $('#dialog-form-3').modal('show');
            });
            return false;
        });
    });
</script>
