@using System.Globalization
@model FDI.Admin.Models.DetailsViewModel
@{
    ViewBag.Title = "User Details: " + Model.DisplayName;
    Layout = "~/Views/Shared/_Meta.cshtml";
}

<div class="header-control">
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li><a href="/"><i class="fa fa-home"></i>Home</a><i class="fa fa-circle"></i></li>
            <li class="active">Đổi mật khẩu</li>
        </ul>
    </div>
    <h3 class="page-title">
        Quản lý quản trị viên: <small>@Model.DisplayName [@Model.Status]</small>
    </h3>
</div>
<div class="content-control">
    <div class="row">
        <div class="col-md-6">
            <div class="portlet box blue">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-lock"></i>Đổi mới mật khẩu
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="form-horizontal">
                        @if (Model.User.IsLockedOut)
                        {
                            <p>Locked out since @Model.User.LastLockoutDate.ToString("MMMM dd, yyyy h:mm:ss tt", CultureInfo.InvariantCulture)</p>
                            using (Html.BeginForm("Unlock", "UserAdministration", new { id = Model.User.ProviderUserKey }))
                            {
                                <input type="submit" value="Unlock Account" />
                            }
                        }
                        else
                        {
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Thay đổi lần cuối</label>
                                <div class="col-sm-9">
                                    @if (Model.User.LastPasswordChangedDate == Model.User.CreationDate)
                                    {
                                        <p class="form-control-static">Never</p>
                                    }
                                    else
                                    {
                                        <p class="form-control-static">@Model.User.LastPasswordChangedDate.ToString("dd/MM/yyyy h:mm:ss tt", CultureInfo.InvariantCulture)</p>
                                    }
                                </div>
                            </div>

                            if (Model.CanResetPassword && Model.RequirePasswordQuestionAnswerToResetPassword)
                            {
                                using (Html.BeginForm("ResetPasswordWithAnswer", "UserAdministration", new { id = Model.User.ProviderUserKey }))
                                {
                                    <fieldset>
                                        <p>
                                            <dl>
                                                <dt>Password Question:</dt>
                                                if(string.IsNullOrEmpty(Model.User.PasswordQuestion) || string.IsNullOrEmpty(Model.User.PasswordQuestion.Trim())){
                                                <dd><em>No password question defined.</em></dd>
                                                }else{
                                                <dd>@Model.User.PasswordQuestion</dd>
                                                }
                                            </dl>
                                        </p>
                                        <p>
                                            <label for="answer">Password Answer:</label>
                                            @Html.TextBox("answer")
                                        </p>
                                        <input type="submit" class="btn btn-sm btn-primary" value="Reset to Random Password and Email User" />
                                    </fieldset>
                                }
                            }
                            else if (Model.CanResetPassword)
                            {
                                using (Html.BeginForm("SetPassword", "UserAdministration", new { id = Model.User.ProviderUserKey }))
                                {

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">Mật khẩu mới</label>
                                        <div class="col-sm-9">
                                            <input type="text" class="form-control" placeholder="..." name="password" id="password" value="" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-9">
                                            <input type="submit" class="btn btn-sm btn-primary" value="Đổi mật khẩu" />
                                        </div>
                                    </div>

                                }
                                using (Html.BeginForm("ResetPassword", "UserAdministration", new { id = Model.User.ProviderUserKey }))
                                {

                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-9">
                                            <input type="submit" class="btn btn-sm btn-primary" value="Tạo password mặc ngẫu nhiên và gửi đến email" />
                                        </div>
                                    </div>
                                }
                            }

                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
